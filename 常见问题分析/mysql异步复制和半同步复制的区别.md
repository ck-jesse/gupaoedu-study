# Mysql 复制
在mysql5.5版本之前，复制都是异步复制。

## 异步复制造成主从数据不一致的问题？
    分析：
       因为binlog日志是推送的，所有主库和从库之间存在一定的延迟。 
       这样就会造成很多问题，比如主库因为磁盘损坏等故障突然崩掉，导致binlog日志不存在，
       同时因为延迟binlog还没有推送到从库，从库也就会丢失很多被主库提交的事物，从而造成主从不一致。
    方案：
        mysql5.5版本之后引入了半同步复制机制来解决该问题。
    

## 异步复制
    1、主库上事务commit提交并执行成功
    2、将日志记录到binlog
    3、将结果反馈给客户端
    4、最后将日志传输给从库（从库先将日志写入中继日志，然后执行中继日志中的SQL，以便在从库上使数据生效）
    （异步传输，也就是异步复制）

## 半同步复制
    1、主库上事务commit提交并执行成功
    2、将日志记录到binlog
    3、将日志传输给从库，并等待从库将日志成功写入到中继日志（此时SQL还未在从库上执行，猜想应该是通过一个异步线程去从中继日志中获取SQL然后执行的。）
    4、将结果反馈给客户端
    
    半同步复制保障了事物执行后，至少有两份日志记录，一份在主库的binlog上 ，另一份至少在从库的中继日志Relay log上，这样就极大的保证了数据的一致性。
    
    
思考：
如果有多个从库时，半同步复制流程中将日志传输给多个从库的步骤后，是怎么处理多个从库的响应的？
分析：
猜想主库只要获取到一个从库将日志成功写入到中继日志的响应，主库就将结果反馈给客户端。也就极大的保证了数据的一致性。